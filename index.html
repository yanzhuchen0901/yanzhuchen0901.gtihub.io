<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¦–é¡µ - Chen.ã®homepage</title>

    <meta http-equiv="Cache-Control" content="no-store" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <link rel="stylesheet" href="static/header.css">
    <link rel="stylesheet" href="static/hero.css">
    <link rel="stylesheet" href="static/styles.css">
    <link rel="icon" href="favicon.ico" />
</head>

<body>

    <canvas id="starfield" class="starfield-canvas" aria-hidden="true"></canvas>

    <header id="header">
        <div style="display:flex; align-items:center; gap:12px; width:100%; max-width:1100px; justify-content:space-between;">
            <div style="font-weight:bold; font-size:18px;">Chen.ã®homepage</div>
            <div>
                <a href="focus.html" class="nav-btn">ä¸“æ³¨è®¡æ—¶å™¨</a>
                <a href="gallery.html" class="nav-btn">å…‰å½±ç•™ç—•</a>
                <a href="https://yanzhuchen0901.github.io/notes/" class="nav-btn" target="_blank" rel="noopener noreferrer">ç¬”è®°</a>
            </div>
        </div>
    </header>

    <section class="hero">
        <div class="hero-content">
            <h1 class="greeting">âœ¨æ¬¢è¿æ¥åˆ°Chen.ã®homepageğŸ§¤</h1>
            <div class="typed-wrapper">
                <span id="typed" class="typed-text"></span>
                <span class="cursor" aria-hidden="true"></span>
            </div>
        </div>
    </section>

    <!-- ç²¾é€‰å…‰å½±ç•™ç—• - æ¨ªå‘æ»šåŠ¨ -->
    <div class="content">
        <h2 style="color:white; text-align:center; margin-top:30px;">ç²¾é€‰å…‰å½±</h2>
        <div id="featuredPhotosContainer" class="featured-photos-scroll"></div>
    </div>

    <!-- å¦™ç¬”ç”ŸèŠ± - ç²¾é€‰æ–‡ç«  -->
    <div class="content">
        <h2 style="color:white; text-align:center; margin-top:30px;">å¦™ç¬”ç”ŸèŠ±</h2>
        <div id="articlesContainer" class="articles-grid"></div>
    </div>

    <!-- æ›´æ–°é¢‘ç‡ç»Ÿè®¡ -->
    <div class="content">
        <h2 style="color:white; text-align:center; margin-top:30px;">æ›´æ–°é¢‘ç‡ç»Ÿè®¡</h2>
        <div id="heatmapContainer" class="heatmap"></div>
        <div class="heat-legend">
            <span>å°‘</span>
            <div class="legend-blocks">
                <div class="legend-cell level-0"></div>
                <div class="legend-cell level-1"></div>
                <div class="legend-cell level-2"></div>
                <div class="legend-cell level-3"></div>
                <div class="legend-cell level-4"></div>
            </div>
            <span>å¤š</span>
        </div>
    </div>

    <!-- æ›´æ–°æ—¥å¿— - æ—¶é—´çº¿ -->
    <div class="content">
        <h2 style="color:white; text-align:center; margin-top:30px;">æ›´æ–°æ—¥å¿—</h2>
        <div id="changelog-container" class="changelog-timeline"></div>
    </div>

    <script src="static/data.js"></script>
    <script>
        // ç²¾é€‰å…‰å½±ç…§ç‰‡æ•°æ® - ä¼˜å…ˆè¯»å–æœ¬åœ°å›¾ç‰‡åº“é…ç½®ï¼Œå¦åˆ™å›é€€åˆ° localStorage
        function getFeaturedPhotos(limit) {
            const maxCount = limit || 10;
            const featured = Array.isArray(window.FEATURED_LIGHTTRACE) ? window.FEATURED_LIGHTTRACE : [];
            if (featured.length > 0) {
                return featured.slice(0, maxCount).map(item => ({
                    data: item.src,
                    comment: item.comment || '',
                    fileName: item.id || item.src || ''
                }));
            }

            try {
                const stored = localStorage.getItem('gallery_images_v1');
                const images = stored ? JSON.parse(stored) : [];
                return images.slice(0, maxCount); // è‡ªåŠ¨è®¡ç®—æ˜¾ç¤ºæ•°é‡
            } catch (e) {
                return [];
            }
        }

        function getFeaturedPhotoLimit() {
            const container = document.getElementById('featuredPhotosContainer');
            if (!container) return 12;
            const width = container.clientWidth;
            if (!width) return 12;
            // æ‰‹æœºç«¯æ˜¾ç¤º4å¼ ï¼ˆ2è¡Œ2åˆ—ï¼‰
            if (width < 768) {
                return 4;
            }
            const itemSize = 160;
            const gap = 12;
            const padding = 32;
            const usable = Math.max(0, width - padding);
            const columns = Math.max(1, Math.floor((usable + gap) / (itemSize + gap)));
            return Math.max(12, columns * 2);
        }

        // æ¸²æŸ“ç²¾é€‰å…‰å½±
        function renderFeaturedPhotos() {
            const container = document.getElementById('featuredPhotosContainer');
            const limit = getFeaturedPhotoLimit();
            const photos = getFeaturedPhotos(limit);

            if (photos.length === 0) {
                container.innerHTML = '<div style="text-align:center; color:rgba(255,255,255,0.5); padding:40px;">æš‚æ— å…‰å½±ç•™ç—•ï¼Œ<a href="gallery.html" style="color:#ffa500;">å»ä¸Šä¼ </a></div>';
                return;
            }

            container.innerHTML = '';
            const scroll = document.createElement('div');
            scroll.className = 'photos-scroll-wrapper';

            photos.forEach(photo => {
                const item = document.createElement('div');
                item.className = 'photo-item';
                item.innerHTML = `
                    <img src="${photo.data}" alt="" title="${photo.fileName || ''}">
                    <div class="photo-comment">${photo.comment || ''}</div>
                `;
                item.addEventListener('click', () => {
                    window.location.href = 'gallery.html';
                });
                scroll.appendChild(item);
            });

            container.appendChild(scroll);
        }

        let featuredResizeTimer = null;
        window.addEventListener('resize', () => {
            clearTimeout(featuredResizeTimer);
            featuredResizeTimer = setTimeout(renderFeaturedPhotos, 150);
        });

        // å¦™ç¬”ç”ŸèŠ± - ç²¾é€‰æ–‡ç« æ•°æ®
        // æ•°æ®å­—æ®µè¯´æ˜:
        // - id: æ–‡ç« ID
        // - title: æ–‡ç« æ ‡é¢˜
        // - description: æ–‡ç« ç®€è¿°
        // - image: å¡ç‰‡æ˜¾ç¤ºçš„å›¾ç‰‡URLï¼ˆç¼©ç•¥å›¾ï¼‰
        // - link: ç‚¹å‡»å¡ç‰‡åè·³è½¬çš„é“¾æ¥URL
        // - comment: è¯„æ³¨/æ ‡ç­¾
        const articles = [{
            id: 1,
            title: "pythonè¿›é˜¶è®²ä¹‰",
            description: "åŸºäºGeminishen'chengçš„ä¸€ä»½pyè¿›é˜¶è®²ä¹‰ï¼Œä¸»è¦é’ˆå¯¹CS61Açš„å­¦ä¹ è€…",
            image: "photos/photo1.webp",
            link: "https://yanzhuchen0901.github.io/notes/#/computer-science/UCB%20CS61A/python",
            comment: "å­¦ä¹ å¤©åœ°"
        }, {
            id: 2,
            title: "æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦å»æ¸¸ä¹å›­",
            description: "è®°å½•äºé«˜ä¸­å»æ¸¸ä¹å›­åçš„è¿”ç¨‹",
            image: "photos/photo2.png",
            link: "https://yanzhuchen0901.github.io/notes/#/Diary/amusementpark",
            comment: "å…‰é˜´éšç¬”"
        }, {
            id: 3,
            title: "CET-6æ­£è¯¾ç¬”è®°",
            description: "è®°å½•å…­çº§æ­£è¯¾çš„å¬åŠ›ã€é˜…è¯»ã€å†™ä½œç¬”è®°ï¼ŒæŒç»­æ›´æ–°ä¸­",
            image: "photos/photo3.jpg",
            link: "https://yanzhuchen0901.github.io/notes/#/English/CET-6/translation_and_writing1",
            comment: "å­¦ä¹ å¤©åœ°"
        }];

        // æ›´æ–°æ—¥å¿—æ•°æ®
        const changelog = [{
            date: "2026-02-13",
            title: "æ–°å¢å…‰å½±ç•™ç—•ç”»å»Š",
            description: "æ”¯æŒå›¾ç‰‡ä¸Šä¼ ã€æŸ¥çœ‹ã€è¯„æ³¨åŠŸèƒ½ï¼Œå®Œæ•´çš„å‰ç«¯å®ç°"
        }, {
            date: "2026-02-12",
            title: "ä¼˜åŒ–æ›´æ–°é¢‘ç‡ç»Ÿè®¡",
            description: "æ”¹è¿›çƒ­åŠ›å›¾å±•ç¤ºï¼Œæå‡ç”¨æˆ·ä½“éªŒ"
        }, {
            date: "2026-02-10",
            title: "å¦™ç¬”ç”ŸèŠ±æ¨¡å—ä¸Šçº¿",
            description: "ç²¾é€‰æ–‡ç« å¡ç‰‡åŒ–å±•ç¤ºï¼Œæ”¯æŒå“åº”å¼å¸ƒå±€"
        }, {
            date: "2026-02-08",
            title: "ä¸»é¡µå¤§æ”¹ç‰ˆ",
            description: "ç§»é™¤æ ‡ç­¾é¡µåŠŸèƒ½ï¼Œé‡æ„å¯¼èˆªèœå•ç»“æ„"
        }, {
            date: "2026-02-05",
            title: "ä¿®å¤æ ·å¼å…¼å®¹æ€§é—®é¢˜",
            description: "æ”¹è¿›ç§»åŠ¨ç«¯é€‚é…ã€ä¼˜åŒ–æ·±è‰²ä¸»é¢˜"
        }];

        // æ¸²æŸ“å¦™ç¬”ç”ŸèŠ±
        function renderArticles() {
            const container = document.getElementById('articlesContainer');
            container.innerHTML = '';
            const grid = document.createElement('div');
            grid.className = 'articles-grid';

            articles.forEach(article => {
                const card = document.createElement('div');
                card.className = 'article-card';
                card.style.cursor = 'pointer';
                card.innerHTML = `
                    <div class="article-image">
                        <img src="${article.image}" alt="${article.title}">
                    </div>
                    <div class="article-content">
                        <h3>${article.title}</h3>
                        <p>${article.description}</p>
                        <div class="article-comment">${article.comment}</div>
                    </div>
                `;
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶ - è·³è½¬åˆ°æ–‡ç« é“¾æ¥
                card.addEventListener('click', () => {
                    window.open(article.link, '_blank');
                });
                grid.appendChild(card);
            });

            container.appendChild(grid);
        }

        // æ¸²æŸ“æ›´æ–°æ—¥å¿—
        function renderChangelog() {
            const container = document.getElementById('changelog-container');
            container.innerHTML = '';
            const timeline = document.createElement('div');
            timeline.className = 'timeline';

            changelog.forEach((log, index) => {
                const item = document.createElement('div');
                item.className = 'timeline-item';
                item.innerHTML = `
                    <div class="timeline-marker"></div>
                    <div class="timeline-content">
                        <div class="timeline-date">${log.date}</div>
                        <div class="timeline-title">${log.title}</div>
                        <div class="timeline-description">${log.description}</div>
                    </div>
                `;
                timeline.appendChild(item);
            });

            container.appendChild(timeline);
        }
    </script>
    <script>
        // æ¸²æŸ“ç®€å•çš„ GitHub é£æ ¼çƒ­å›¾ï¼ˆæœ€è¿‘ 52 å‘¨ï¼‰
        async function renderHeatmap() {
            const counts = getHeatmapData();

            const container = document.getElementById('heatmapContainer');
            container.innerHTML = '';
            const today = new Date();
            // ä»¥å‘¨ä¸ºåˆ—ï¼Œ52 åˆ—ï¼Œæ¯åˆ— 7 å¤©
            const weeks = 52;
            const oneDay = 24 * 60 * 60 * 1000;

            const endDate = new Date(today.getFullYear(), today.getMonth(), today.getDate());

            for (let w = weeks - 1; w >= 0; w--) {
                const col = document.createElement('div');
                col.className = 'heat-col';
                for (let d = 6; d >= 0; d--) {
                    const cell = document.createElement('div');
                    cell.className = 'heat-cell level-0';
                    const dayOffset = w * 7 + d;
                    const date = new Date(endDate.getTime() - dayOffset * oneDay);
                    const y = date.getFullYear();
                    const m = String(date.getMonth() + 1).padStart(2, '0');
                    const day = String(date.getDate()).padStart(2, '0');
                    const key = `${y}-${m}-${day}`;
                    const value = counts[key] || 0;
                    let lvl = 0;
                    if (value >= 4) lvl = 4;
                    else if (value >= 3) lvl = 3;
                    else if (value >= 2) lvl = 2;
                    else if (value >= 1) lvl = 1;
                    cell.className = 'heat-cell level-' + lvl;
                    cell.title = `${key}: ${value}`;
                    col.appendChild(cell);
                }
                container.appendChild(col);
            }
        }

        // ä»…åœ¨ç”¨æˆ·æ»šåŠ¨åæ˜¾ç¤ºçƒ­å›¾ï¼ˆä¸ header ä¸€è‡´çš„æ˜¾ç¤ºé€»è¾‘ï¼‰
        function setupScrollReveal() {
            const heat = document.getElementById('heatmapContainer');
            if (heat) heat.style.opacity = 0;
            window.addEventListener('scroll', () => {
                const scrollY = window.scrollY;
                const windowH = window.innerHeight;
                let opacity = Math.min(1, Math.max(0, (scrollY - windowH / 2) / (windowH / 2)));
                if (heat) heat.style.opacity = opacity;
            });
        }

        renderFeaturedPhotos();

        // åˆå§‹åŒ–ç¤ºä¾‹æ•°æ®åˆ°çƒ­åŠ›å›¾ï¼ˆå¦‚æœlocalStorageä¸ºç©ºï¼‰
        (function initSampleHeatmapData() {
            const RECORDS_PREFIX = 'daily_record_';
            let hasData = false;

            // æ£€æŸ¥æ˜¯å¦å·²æœ‰æ•°æ®
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith(RECORDS_PREFIX)) {
                    hasData = true;
                    break;
                }
            }

            // å¦‚æœæ²¡æœ‰æ•°æ®ï¼Œæ·»åŠ ç¤ºä¾‹æ•°æ®
            if (!hasData) {
                const today = new Date();
                // æ·»åŠ æœ€è¿‘30å¤©çš„ç¤ºä¾‹æ•°æ®
                for (let i = 0; i < 30; i++) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    const y = date.getFullYear();
                    const m = String(date.getMonth() + 1).padStart(2, '0');
                    const d = String(date.getDate()).padStart(2, '0');
                    const key = `${RECORDS_PREFIX}${y}-${m}-${d}`;

                    // éšæœºç”Ÿæˆæ´»è·ƒåº¦ï¼ˆ0-6ï¼‰
                    const activity = Math.floor(Math.random() * 6);

                    if (activity > 0) {
                        const sampleData = {
                            date: `${y}-${m}-${d}`,
                            keywords: activity > 2 ? ["æ›´æ–°"] : [],
                            today_done: activity > 1 ? "å®Œæˆäº†ä¸€äº›å·¥ä½œ" : "",
                            tomorrow_plan: activity > 3 ? ["ç»§ç»­åŠªåŠ›"] : [],
                            insights: activity > 3 ? "æœ‰æ‰€æ”¶è·" : "",
                            todos: activity > 2 ? ["ä»»åŠ¡1"] : [],
                            focus_sessions: activity > 1 ? [{
                                duration: 30
                            }] : []
                        };
                        localStorage.setItem(key, JSON.stringify(sampleData));
                    }
                }
            }
        })();

        renderHeatmap();
        setupScrollReveal();
        renderArticles();
        renderChangelog();

        // åˆå§‹åŒ– header ä¸ºéšè—çŠ¶æ€
        const header = document.getElementById("header");
        const hero = document.querySelector(".hero");
        if (header) header.style.opacity = 0;

        window.addEventListener("scroll", () => {
            const scrollY = window.scrollY;
            const windowH = window.innerHeight;

            if (hero) {
                let heroOpacity = Math.max(0, 1 - scrollY / windowH);
                hero.style.opacity = heroOpacity;
            }

            if (header) {
                let headerOpacity = Math.min(1, Math.max(0, (scrollY - windowH / 2) / (windowH / 2)));
                header.style.opacity = headerOpacity;
            }
        });
    </script>

    <script>
        // ç®€å•æ‰“å­—æœºå¾ªç¯æ•ˆæœï¼ˆç§»åŠ¨ç«¯å‹å¥½ã€æ— å¤–éƒ¨ä¾èµ–ï¼‰
        (function() {
            const el = document.getElementById('typed');
            if (!el) return;
            const phrases = ["é™ˆå½¦ç«¹", "Yanzhu ChenğŸ", "ğŸ“–ZJUer", "ğŸ’»CS Learner", "both conter strike & computer science", "Coffeeâ˜• & PingpongğŸ“ Lover", "Billiards experiencedğŸ±"];
            let pi = 0,
                ci = 0,
                deleting = false;
            const typeSpeed = 90,
                deleteSpeed = 50,
                pause = 1200;

            function tick() {
                const full = phrases[pi];
                if (!deleting) {
                    ci++;
                    el.textContent = full.slice(0, ci);
                    if (ci === full.length) {
                        deleting = true;
                        setTimeout(tick, pause);
                        return;
                    }
                } else {
                    ci--;
                    el.textContent = full.slice(0, ci);
                    if (ci === 0) {
                        deleting = false;
                        pi = (pi + 1) % phrases.length;
                    }
                }
                setTimeout(tick, deleting ? deleteSpeed : typeSpeed);
            }

            // start after small delay for nicer entry
            setTimeout(tick, 400);
        })();
    </script>

    <script src="static/particle-config.js"></script>
    <script src="starfield.js"></script>

</body>

</html>